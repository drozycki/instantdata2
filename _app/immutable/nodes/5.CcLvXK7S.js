import{b as L,_ as ee}from"../chunks/Br3SQTEV.js";import{t as F,a as D,b as ae}from"../chunks/Dq0GJUeH.js";import{q as re,t as k,K as te,g as I,L as ne,M as se,N as $,x as O,w as N,y as q,O as le,P as Z,Q as z,R as ie,T as S,V as G,i as P,W as oe,X as fe,e as V,l as ue,Y as ve,Z as de,_ as _e,$ as ce,a0 as pe,a1 as he,a2 as me,v as ye,p as ge,a3 as K,a as we,a4 as be,s as Q,c as C,a5 as xe,a6 as A,r as H,a7 as U}from"../chunks/C3p6SYRz.js";import{e as Y,s as W}from"../chunks/Bk4Oonam.js";import{p as Ee}from"../chunks/D3_TM0x9.js";import{o as ke,a as Te}from"../chunks/B2-eMpLL.js";import{b as qe}from"../chunks/DSk17JdS.js";function Ae(u,e){return e}function Ie(u,e,a,v){for(var l=[],i=e.length,n=0;n<i;n++)de(e[n].e,l,!0);var p=i>0&&l.length===0&&a!==null;if(p){var c=a.parentNode;_e(c),c.append(a),v.clear(),w(u,e[0].prev,e[i-1].next)}ce(l,()=>{for(var h=0;h<i;h++){var t=e[h];p||(v.delete(t.k),w(u,t.prev,t.next)),pe(t.e,!p)}})}function X(u,e,a,v,l,i=null){var n=u,p={flags:e,items:new Map,first:null};k&&te();var c=null,h=!1,t=ne(()=>{var o=a();return ue(o)?o:o==null?[]:G(o)});re(()=>{var o=I(t),s=o.length;if(h&&s===0)return;h=s===0;let d=!1;if(k){var f=n.data===se;f!==(s===0)&&(n=$(),O(n),N(!1),d=!0)}if(k){for(var m=null,y,r=0;r<s;r++){if(q.nodeType===8&&q.data===le){n=q,d=!0,N(!1);break}var _=o[r],b=v(_,r);y=J(q,p,m,null,_,b,r,l,e,a),p.items.set(b,y),m=y}s>0&&O($())}k||Me(o,p,n,l,e,v,a),i!==null&&(s===0?c?Z(c):c=z(()=>i(n)):c!==null&&ie(c,()=>{c=null})),d&&N(!0),I(t)}),k&&(n=q)}function Me(u,e,a,v,l,i,n){var p=u.length,c=e.items,h=e.first,t=h,o,s=null,d=[],f=[],m,y,r,_;for(_=0;_<p;_+=1){if(m=u[_],y=i(m,_),r=c.get(y),r===void 0){var b=t?t.e.nodes_start:a;s=J(b,e,s,s===null?e.first:s.next,m,y,_,v,l,n),c.set(y,s),d=[],f=[],t=s.next;continue}if(Re(r,m,_),(r.e.f&S)!==0&&Z(r.e),r!==t){if(o!==void 0&&o.has(r)){if(d.length<f.length){var x=f[0],g;s=x.prev;var M=d[0],T=d[d.length-1];for(g=0;g<d.length;g+=1)B(d[g],x,a);for(g=0;g<f.length;g+=1)o.delete(f[g]);w(e,M.prev,T.next),w(e,s,M),w(e,T,x),t=x,s=T,_-=1,d=[],f=[]}else o.delete(r),B(r,t,a),w(e,r.prev,r.next),w(e,r,s===null?e.first:s.next),w(e,s,r),s=r;continue}for(d=[],f=[];t!==null&&t.k!==y;)(t.e.f&S)===0&&(o??=new Set).add(t),f.push(t),t=t.next;if(t===null)continue;r=t}d.push(r),s=r,t=r.next}if(t!==null||o!==void 0){for(var E=o===void 0?[]:G(o);t!==null;)(t.e.f&S)===0&&E.push(t),t=t.next;var R=E.length;if(R>0){var j=null;Ie(e,E,j,c)}}P.first=e.first&&e.first.e,P.last=s&&s.e}function Re(u,e,a,v){oe(u.v,e),u.i=a}function J(u,e,a,v,l,i,n,p,c,h){var t=(c&he)!==0,o=(c&me)===0,s=t?o?fe(l):V(l):l,d=(c&ve)===0?n:V(n),f={i:d,v:s,k:i,a:null,e:null,prev:a,next:v};try{return f.e=z(()=>p(u,s,d,h),k),f.e.prev=a&&a.e,f.e.next=v&&v.e,a===null?e.first=f:(a.next=f,a.e.next=f.e),v!==null&&(v.prev=f,v.e.prev=f.e),f}finally{}}function B(u,e,a){for(var v=u.next?u.next.e.nodes_start:a,l=e?e.e.nodes_start:a,i=u.e.nodes_start;i!==v;){var n=ye(i);l.before(i),i=n}}function w(u,e,a){e===null?u.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}var De=F(` <!>
`,1),Ne=F(`<pre class="text-sm whitespace-pre-wrap"><code><!>
</code>
</pre> <form class="fixed bottom-0 font-mono text-sm"><input class="w-screen border-t-1 bg-white p-1" type="text" placeholder="Enter SQL query"></form>`,1);function Ve(u,e){ge(e,!0);let a,v,l,i=Ee([]),n=-1,p="",c=0;function h(r){l.focus(),i.length&&(r.key==="ArrowUp"?n===-1?(p=l.value,n=i.length-1,l.value=i[n]?.query||""):n>0&&(l.value=i[--n]?.query||""):r.key==="ArrowDown"&&(n===i.length-1?(l.value=p,n=-1):n!==-1&&n<i.length-1&&(l.value=i[++n]?.query||"")))}ke(async()=>{const r=(await ee(async()=>{const{default:_}=await import("../chunks/sRMH61YM.js");return{default:_}},[],import.meta.url)).default;a=new r,a.postMessage({message:"open",url:`${qe}/db.sqlite`}),a.onmessage=async({data:_})=>{if(_.message==="ready")l.value="SELECT * FROM sqlite_schema;",v.requestSubmit();else if(_.message==="result")i.push({query:l.value,result:_.result,key:++c}),l.value="",await xe(),window.scrollTo({top:document.body.scrollHeight,behavior:"instant"}),l.disabled=!1;else throw new Error("Unknown worker message type")}}),Te(()=>a?.terminate());function t(){l.disabled=!0,n=-1,p="",a?.postMessage({message:"query",query:l.value})}var o=Ne();Y("keydown",be,h);var s=K(o),d=C(s),f=C(d);X(f,17,()=>i,r=>r.key,(r,_)=>{A();var b=De(),x=K(b),g=Q(x);X(g,17,()=>I(_).result,Ae,(M,T)=>{A();var E=ae();U(R=>W(E,`
${R??""}`),[()=>I(T).join("|")]),D(M,E)}),A(),U(()=>W(x,`> ${I(_).query??""}`)),D(r,b)}),A(),H(d),A(),H(s);var m=Q(s,2),y=C(m);L(y,r=>l=r,()=>l),H(m),L(m,r=>v=r,()=>v),Y("submit",m,t),D(u,o),we()}export{Ve as component};
